<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Book Details - Book Nook</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(to bottom right, rgba(0,0,0,0.9), rgba(58,25,94,0.6));
    }
    textarea {
      resize: vertical;
    }
  </style>
</head>
<body class="font-sans text-gray-800 min-h-screen">


  <!-- Book Nook Header -->
   <header class="text-center py-6 text-white text-3xl font-bold tracking-wider">
    Book Nook
 </header>
 <div class="grid grid-cols-1 lg:grid-cols-4 gap-4 p-4 max-w-7xl mx-auto">
    
  <!-- Left Sidebar -->
  <aside class="lg:col-span-1 space-y-6 sticky top-4 self-start">
    <div class="bg-white p-4 rounded-2xl shadow">
      <div class="flex items-center space-x-4">
          <img src="{{ user.profile_pic or 'https://i.pravatar.cc/60' }}" class="rounded-full w-12 h-12">
          <div>
          <h2 class="font-bold text-lg">{{ user.name }}</h2>
          <p class="text-sm text-gray-500">@{{ user.username }}</p>
          <p class="text-sm text-gray-500">üìñ Reading: {{ user.currently_reading }}</p>
        </div>
      </div>
    </div>

    <nav class="bg-white p-4 rounded-2xl shadow space-y-3 text-base">
      <a href="/bookshelves" class="block hover:underline">üìö My Bookshelves</a>
      <a href="/reviews" class="block hover:underline">‚úçÔ∏è My Reviews</a>
      <a href="/recommend" class="block hover:underline">üí¨ Recommend</a>
      <a href="/search" class="block hover:underline">üéØ Search</a>
      <a href="/stats" class="block hover:underline">üìä Stats</a>
      <a href="/logout" class="block text-red-600 hover:underline">üö™ Logout</a>
    </nav>
  </aside>

    <!-- Main Content -->
    <main class="lg:col-span-2 space-y-6">
      <div id="bookDetails" class="bg-white text-black p-6 rounded-2xl shadow space-y-4">
        <!-- Dynamically filled -->
      </div>

      <!-- Add to Bookshelf -->
      <div class="bg-white text-black p-6 rounded-2xl shadow space-y-4">
        <h2 class="text-xl font-bold">üìö Add to Bookshelf</h2>
        <div class="space-y-2">
          <select class="w-full p-2 border border-gray-300 rounded" id="bookshelfSelect">
            <option value="">Select Existing Shelf</option>
            <option value="favorites">Favorites</option>
            <option value="to-read">To Read</option>
            <option value="currently-reading">Currently Reading</option>
          </select>
          <input type="text" class="w-full p-2 border border-gray-300 rounded" placeholder="Or Create New Shelf" id="newShelfInput" />
          <button class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">Add Book</button>
        </div>
      </div>

      <!-- Leave a Review -->
      <div class="bg-white text-black p-6 rounded-2xl shadow space-y-4">
        <h2 class="text-xl font-bold">‚≠ê Write a Review</h2>
        <div class="space-y-2">
          <label class="block font-medium">Rating</label>
          <select id="rating" class="w-full p-2 border border-gray-300 rounded">
            <option>1 ‚≠ê</option>
            <option>2 ‚≠ê‚≠ê</option>
            <option>3 ‚≠ê‚≠ê‚≠ê</option>
            <option>4 ‚≠ê‚≠ê‚≠ê‚≠ê</option>
            <option>5 ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
          </select>

          <label class="block font-medium mt-2">Review</label>
          <textarea class="w-full p-2 border border-gray-300 rounded" rows="4" placeholder="What did you think about the book?"></textarea>
          <button class="bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">Submit Review</button>
        </div>
      </div>
    </main>

    <!-- Right Sidebar -->
    <aside class="lg:col-span-1 space-y-6 sticky top-4 self-start">
      <div class="bg-white text-black p-4 rounded-2xl shadow">
        <h2 class="font-bold text-lg mb-2">üìñ Recommendations</h2>
        <ul class="space-y-2 text-sm">
          <li>‚Ä¢ If We Were Villains</li>
          <li>‚Ä¢ The Secret History</li>
          <li>‚Ä¢ Six of Crows</li>
        </ul>
      </div>

      <div class="bg-white text-black p-4 rounded-2xl shadow">
        <h2 class="font-bold text-lg mb-2">üî• Trending Books</h2>
        <ul class="space-y-2 text-sm">
          <li>‚Ä¢ A Little Life</li>
          <li>‚Ä¢ Iron Flame</li>
          <li>‚Ä¢ Divine Rivals</li>
        </ul>
      </div>
    </aside>
  </div>

  <script>
  const bookKey = "/{{ book_key }}"; // <-- passed from Flask route

async function loadBookDetails() {
  if (!bookKey) {
    document.getElementById('bookDetails').innerHTML = "<p>Book key not provided.</p>";
    return;
  }

  const res = await fetch(`https://openlibrary.org${bookKey}.json`);
  const book = await res.json();

  const title = book.title || "No Title";
  const description = book.description?.value || book.description || "No description available.";
  const coverID = book.covers ? book.covers[0] : null;
  const coverURL = coverID
    ? `https://covers.openlibrary.org/b/id/${coverID}-L.jpg`
    : 'https://via.placeholder.com/200x300?text=No+Cover';

  const authorRes = book.authors?.[0]?.author?.key
    ? await fetch(`https://openlibrary.org${book.authors[0].author.key}.json`)
    : null;
  const authorData = authorRes ? await authorRes.json() : null;
  const authorName = authorData?.name || "Unknown Author";

  document.getElementById('bookDetails').innerHTML = `
    <div class="flex flex-col md:flex-row gap-6">
      <img src="${coverURL}" class="w-40 h-60 object-cover rounded shadow" />
      <div class="space-y-2">
        <h1 class="text-3xl font-bold">${title}</h1>
        <p class="text-md text-gray-600">üë§ ${authorName}</p>
        <p class="text-sm text-gray-700">${description}</p>
      </div>
    </div>
  `;
}

window.onload = loadBookDetails;


  </script>

</body>
</html>
